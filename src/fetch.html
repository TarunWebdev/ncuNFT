<html>
  <head>
    <!-- Moralis SDK code -->
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="https://unpkg.com/moralis/dist/moralis.js"></script>
  </head>
  <style>
    div#content{
    display: flex;
    flex-wrap: wrap;
    max-width: 85%;
    align-items: center;
    justify-content: center;
    margin: auto;
  }

  div.nft {
    width: 24%;
    display: flex;
    flex-direction: column;
    align-items: center;
    border: 1px solid #eee;
  }
  </style>

  <body>
    <h1>Polygon NFT Demo</h1>
    <div id="content"></div>

    <input id="nftaddress" type="text">
    <button onclick="getNFT()">Searcher</button>

    <script>


      // connect to Moralis server
        Moralis.initialize("j2nFoDMxP7XTEpzQwtyVflJoMI0nXdYs4FBBWaEx");
        Moralis.serverURL = "https://3ydt3eazpluk.usemoralis.com:2053/server";

        async function getNFT(){
            let address = document.getElementById('nftaddress').value;

            const options = { 
                chain: 'mumbai', 
                address: address 
            };
            // Get's NFTS Owned By a user Not present in a smart contract
            const polygonNFTs = await Moralis.Web3.getNFTs(options);
            console.log(polygonNFTs);

            // const options2 = { chain: "mumbai", addresses: "0x4129642B7FF0d18ea86654a340C3Bc20e4B6e368" };
            // const tokenMetadata = await Moralis.Web3API.token.getTokenMetadata(options);
            // console.log(tokenMetadata);

            //Loop over the array
            polygonNFTs.forEach( e => {
                let url = e.token_uri;

                fetch(url)
                .then(response => response.json())
                .then(data => {
                    
                    let currentDiv = document.getElementById("content");
                    let content = `
                    <div class="nft">
                        <p>${data.name}</p>
                        <p>${data.description ? data.description : ""}</p>
                        <img width=100 height=100 src="${data.image}"/>
                    </div>
                    `
                    currentDiv.innerHTML += content;
                })
            })
        }


    </script>
  </body>
</html>